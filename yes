// subscription/subscription-route.js
const express = require('express');
const router = express.Router();
const { NewSubscription, GetSubscriptions, UpdateSubscription, DeleteSubscription } = require("./subscription-controller");
const { checkIfUserIsAuthenticated } = require("../middleware/authorizationMiddleware");


// Create a new subscription
router.route("/")
      .post(checkIfUserIsAuthenticated, NewSubscription)
      .get(GetSubscriptions);

// Update subscription
router.route("/:id").put(UpdateSubscription);

// Delete subscription
router.delete('/deleteSubscription/:subscription_id', DeleteSubscription);

module.exports = router;



// subscription/subscription-route.js
const { NewSubscription, GetSubscriptions, UpdateSubscription, DeleteSubscription } = require("./subscription-controller");
const { checkIfUserIsAuthenticated } = require("../middleware/authorizationMiddleware");


// Create a new subscription
router.post('/newSubscription',checkIfUserIsAuthenticated, NewSubscription);

// Get all subscriptions
router.get('/getSubscription', GetSubscriptions);

// Update subscription
router.put('/updateSubscription/:subscription_id', UpdateSubscription);

// Delete subscription
router.delete('/deleteSubscription/:subscription_id', DeleteSubscription);

module.exports = router;

//subscription/subscription-model.js
const mongoose = require('mongoose');
const Schema = mongoose.Schema;

// Subscription Schema
const subscriptionSchema = new Schema({
    plan: {
        type: String,
        required: true
    },
    price: {
        type: String,
        required: true
    },
    duration: {
        type: String, // e.g. "1 month"
        required: true
    },
    userId: [{
        type: mongoose.Schema.Types.ObjectId,
        ref: 'User',
        required: true
    }],
    features: {
        type: [String],
        required: true
    },
    status: {
        type: String,
        enum: ["active", "inactive", "pending"],
        default: "pending"
    }
}, {timestamps: true});
// Create Subscription model
module.exports = mongoose.model('Subscription', subscriptionSchema);